#!/bin/bash
# ------------------------------------------------------------
# Purpose:
#   Automate PALMER runs for multiple long-read sequencing datasets.
#   For each long-read sample, submit SLURM jobs across chromosomes 1–22.
#   Each job calls 'palmer.sh' with arguments: (data_path, workdir, chr)
# ------------------------------------------------------------

# Path to text file containing list of dataset names (one per line)
LIST="./SMaHT_list_directory/sample_list.txt"

# Directory containing actual long-read data
DATA_BASE="/home/vitalnya/DATA.smart"

# Loop through each long-read dataset in the list
while read -r LONG_READ; do
    [[ -z "$LONG_READ" || "$LONG_READ" == \#* ]] && continue

    # Full path to this dataset’s data
    DATA_PATH="${DATA_BASE}/${LONG_READ}"

    # Define working directory
    WORKDIR="/SMaHT/${LONG_READ}_workingdir"
    mkdir -p "$WORKDIR"

    # Loop through chromosomes 1–22
    for CHR in {1..22}; do
        sbatch palmer.sh "$DATA_PATH" "$WORKDIR" "chr${CHR}"
    done

done < "$LIST"
